# Incident Playbook Schema

[Intro goes here]

## Playbook input parameter descriptions

All playbooks publish the following variables, and they are also available for use in playbook tasks.

* **account_id** (*number*) - Your Alert Logic Managed Detection and Response customer account identifier (for example, 12345678)
* **payload_type** (*string*) - Alert Logic MDR payload type. For an incident playbook, the value is `incident`.
* **payload** (*object*) - Alert Logic MDR payload. For an incident playbook, the payload is for an Alert Logic incident.

### Playbook incident payload schema

The following variables are available for all incident playbooks. These variables are preceded with the word "payload" in VARIABLES selection lists.

* **accountId** (*number*) – Alert Logic customer account identifier (example: 12345678)
* **asset_deployment_type** (*string*) – Deployment type of the asset on which the incident occurred
*Valid values: *`datacenter`, `aws`, `saas`, `azure`
* **asset_host_name** (*string*) – Host name of the asset on which the incident occurred (example: 10.1.2.3)
* **asset_native_account_id** (*string*) – Native account identifier of the asset on which the incident occurred, such as the AWS or Azure account ID (example: 123456789012)
* **attacker** (*object*) – Information about the attacker, if it can be determined
   * **account** (*string*) – Cloud native account identifier (example: 123456789012)
   * **instanceId** (*string*) – Cloud instance identifier of the attacker (example: i-0a159b2a553285ebb)
   * **ip** (*string*) – IP address of the attacker for the incident (example: 10.10.10.12)
   * **port** (*number*) - Port number of the attacker for the incident (example: 40814)
   * **region** (*string*) – Cloud region of the attacker (example: us-east-2)
   * **value** (*string*) - User name, applies to attacks originating from a user instead of an IP address  (example: SomeAttacker)
* **attacker_country_code** (*string*) – ISO two-digit code of the country where the attacker is located, if it can be determined (example: BR)
* **attacker_country_name** (*string*) – Name of the country where the attacker is located, if it can be determined (example: Brazil)
* **attacker_ip**(*string*) – IP address of the attacker for the incident (example: 10.10.10.12)
* **attacker_lset** (*array*) - List of information for multiple attackers
   * **ip** (*string*) – List of attacker IP addresses for the incident (example: 203.0.113.1)
   * **value** (*string*) – List of attacker user names for the incident, applies to attacks originating from a user instead of an IP address (example: SomeAttacker)
* **closed_time** (*string*) – ISO date and time in UTC when an Alert Logic Security Operations Center (SOC) analyst closed the incident (example: 2020-08-10T11:24:27.765796+00:00)
* **correlation_name** (*string*) – Name of the [correlation](../configure/notifications/log-correlation.md) for an incident generated by a correlation rule (example: Admin Failed Login Correlation)
* **createTime** (*number*) – Epoch time when the incident arrived in the Alert Logic server (example: 1597058547)
* **createtime_str** (*string*) –  ISO date and time in UTC when the incident arrived in the Alert Logic server  (example: 2020-08-10T11:22:27.799796+00:00)
* **customer** (*string*) – Customer name of the Alert Logic account affected by the incident (example: XYZ Corporation)
* **customer_feedback** (*object*) - Customer feedback information about the incident
   * **feedback** (*string*) – Text of the customer feedback (example: The wiggle probe server 10.123.10.57 is making multiple failed login attempts to the James MSSQL servers at INC001DB03G, INC001DB06G,  inc001db04g and inc001db05g. This is expected activity in the James environment. \nINC076660)
   * **feedback_datetime** (*string*) – ISO date and time in UTC when the customer entered feedback (example: 2020-08-14T09:57:35.535995+00:00)
   * **feedback_reason** (*string*) – Feedback assessment (example: threat_not_valid)
   * **feedback_uid** (*string*) – User ID of the user who entered the feedback (example: 423A54CE-105F-4089-B713-10A303DE0938)
   * **feedback_user** (*string*) – Name and email address of the user who entered the feedback (example: CustomerFirstName CustomerLastName username@xyz.com)
* **customer_status**  (*object*) - Incident status information set by the customer
   * **notes** (*string*) – Incident assessment notes written by the customer (example: The wiggle probe server 10.123.10.57 is making multiple failed login attempts to the James MSSQL servers at INC001DB03G, INC001DB06G,  inc001db04g and inc001db05g. This is expected activity in the James environment. \nINC076660)
   * **reason_code** (*string*) – Reason for the incident status change (example: threat_not_valid)
   * **status** (*string*) – Incident status set by the customer
   *Valid values: *`open`, `completed`
   * **status_change_time** (*string*) – ISO date and time in UTC when the customer changed the incident status (example: 2020-08-10T11:22:27.799796+00:00)
* **customer_status_status** (*string*) – Incident status set by the customer
*Valid values: *`open`, `completed`
* **defaultThreatRating** (*string*) – Initially assigned threat level
*Valid values:* `critical`, `high`, `medium`, `low`, `info`
* **deployment** (*string*) – Name of the deployment affected by the incident (example: AWS Production Deployment)
* **deployment_subnet** (*string*) – Name of the subnet affected by the incident (example: subnet-a412345g)
* **deployment_type** (*string*) – Deployment type in which the incident occurred
* **deployment_vpc** (*string*) – Name of the virtual private cloud (VPC) affected by the incident (example: vpc-12345678)
* **detection_source** (*string*) – Detection source of the incident
*Valid values: *`Correlation Rules`, `Network IDS`, `Web Log Analytics`, `Log Mgmt`, `Firewall`, `Manual`, `Log Review`,`GuardDuty`,`Web App IDS`
* **first_closed_time** (*string*) – ISO date and time in UTC when an Alert Logic SOC analyst closed the  incident for the first time (example: 2020-09-11T13:22:27.799796+00:00)
* **geo_ip_map** (*object array*) – Geographical information for a list of IP addresses
   * **city** (*string*) – City in which the IP address is located (example: Palmares do Sul)
   * **continentcode** (*string*) – Two-letter ISO code of the continent in which the IP address is located (example: SA)
   * **country** (*string*) – Two-letter ISO code of the country in which the IP address is located (example: BR)
   * **countryname** (*string*) – Name of the country in which the IP address is located (example: Brazil)
   * **ip** (*string*) – IP address (example: 86.34.222.99)
   * **latitude** (*number*) – Latitude in which the IP address is located (example: -30.3465)
   * **longitude** (*number*) – Longitude in which the IP address is located (example: -50.5482)
   * **postcode** (*string*) – Postal code in which the IP address is located (example: 95540)
   * **regioncode** (*string*) – ISO region code in which the IP address is located (example: RS)
   * **regionname** (*string*) – Name of the region in which the IP address is located (example: Rio Grande do Sul)
* **humanFriendlyId** (*string*) – Short incident ID (example: ww1k39)
* **incident** (*object*) – Information about the incident
   * **attackClassId** (*string*)
   * - Incident classification (example: authentication:activity)
   * **description** (*string*) – Incident explanation (example: **Attack Detail**:  \n**Attacker:** 172.31.37.117, local_ip \n**Targets:** 122.99.34.111, 172.31.37.90, and 172.31.39.79 \n We have detected a recon attack targeting a number of common server vulnerabilities. This is a vulnerability scan however we are unable to determine the specific tool or company performing this attack.)
   * **escalated** (*string*) – Whether an Alert Logic SOC analyst escalated the incident
   *Valid values: *`true`, `false`
   * **recommendations** (*string*) – Recommended actions in response to the incident (example: A compromised host should be isolated from the network and cleaned. Remove the back doors installed and check the system logs for other actions taken. Once a system is compromised, usually one of the first things done by an attacker is creating a secondary access channel. Assume that additional modifications have been made to the system beyond the initial breach.)
   * **summary** (*string*) –  Brief description of the incident that is suitable as a title or message subject (example: Brute force attempt from 1.2.3.4)
   * **threatRating** (string)  Incident threat level after analysis (example: Medium)
* **incident_escalated** (*string*) –   Whether an Alert LogicSOC analyst escalated the incident
*Valid values: *`true`, `false`
* **incident_sub_type** (*string*) – Subtype of the incident
* **incident_threat_rating** (*string*) –    Incident threat level after analysis
*Valid values:*`Critical`, `High`, `Medium`, `Low`, `Info`
* **incidentId** (*string*) – Unique incident identifier. For Managed Detection and Response incidents, the value is the full uppercase UUID. For Cloud Defender incidents, the value is a hex 64-bit UUID. (Examples: 5F36660A-0015-0120-0002-104300000000 or ea1118de147187ba)
* **notes** (*array*) - List of notes added by Alert LogicSOC analysts
   * **OtherNotes** (*object*) - Note added by an Alert LogicSOC  analyst
      * **date** (*string*) - ISO date and time in UTC when the analyst added the note (example: 2020-08-10T11:22.27.799796+00:00)
      * **note** (*string*) - Text of the note added by the analyst (example: Normal Activity:\nThere was 1 AWS EC2 Run Instances event with 1 User Type AssumedRole, 1 userName null, 1 sourceIPAddress autoscaling.amazonaws.com, 1 errorCode null, 1 errorMessage null, 1 ARN arn:aws:sts::261161298046:assumed-role/AWSServiceRoleForAutoScaling/AutoScaling, and 1 eventVersion 1.05.\nThis activity occurred on August 13, 2020 between 6:33:00pm and 6:33:00pm EDT.\nCaptured by 1 Log Source US-West-2-OpsTrail.\n\nThere is no unusual activity.)
      * **who** (*string*) - Name and email address of the analyst who added the note (example: AnalystFirstName AnalystLastName <username@alertlogic.com>)
* **snooze_status** (*object*) - Information about an incident temporarily removed from the incident list with the snooze feature
   * **expiration** (*number*) - Epoch time with milliseconds when snooze is set to expire (1597737611.136183)
   * **expiration_str** (*string*) - ISO date and time in UTC when snooze expires (example: 2020-08-10T11:22:27.799796+00:00)
   * **notes** (*string*) - Notes added when the incident was snoozed (example: Check with Sally tomorrow)
   * **period_ms** (*number*) - Snooze time period in milliseconds (example: 60000)
   * **reactivates_at** (*string*) - Time when the incident reactivates and snooze ends (example: 2020-08-10T11:22:27.799796+00:00)
   * **reason_code** (*string*) - Snooze duration selected
   *Valid values: *`tomorrow`, `in couple of days`, `next week`, `in two weeks`
   * **snooze_by** (*string*) - Name and email address of the user who snoozed the incident (example: CustomerFirstName CustomerLastName username@xyz.com)
   * **snooze_by_uid** (*string*) - User ID of the user who snoozed the incident (example: CBAA2703-B7F6-43E6-8B17-F75A04A5423E)
   * **snoozed** (*Boolean*) - Whether the incident is snoozed
   *Valid values: *`true`, `false`
* **snooze_status_snoozed** (*Boolean*) - Whether the incident is snoozed, extracted from `snooze_status`
*Valid values: *`true`, `false`
* **sources** (*array*) -  List that contains one entry that indicates the telemetry source of the incident (examples: `logreview`, `IDS`, `LOG`, `CLOG`, `FW`)
* **stack_region** (*string*) - Internal value that refers to the Alert Logic region of the customer account in which the incident occurred
*Valid values:*`cd-us-production`, `cd-uk-production`
* **updateTime** (*number*) - Epoch time of the last update to the incident  (example: 1597348547)
* **updatetime_str** (*string*) - ISO date and time in UTC of the last update to the incident  (example: 2020-09-11T16:23:47.734796+00:00)
* **victim** (*object*) - Information about the target of the incident, if it can be determined
   * **ip** (*string*)  – IP address of the target for the incident (example: 203.0.113.1)
   * **port** (*number*) - Port number of the target for the incident (example: 40814)
   * **protocol** (*string*) - Network protocol of the target for the incident (example: TCP)
   * **value** (*string*) - User name, applies to attacks that target a user instead of an IP address (example: SomeTarget)
* **victim_lset** (*array*) - List of target IP addresses of the incident or targeted users, if they could be determined
   * **ip** (*string*)  – List of target IP addresses of the incident (example: 203.0.113.1)
   * **value** (*string*) - List of target user names, applies to attacks that target a user instead of an IP address (example: SomeTarget)

## Playbook variables

[This will describe Playbook Vars in the VARIABLES selection lists.]
